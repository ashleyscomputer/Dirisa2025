<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Driver Behaviour & Road Safety Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.3.0/dist/chartjs-chart-matrix.min.js"></script>
  <style>
    :root {
      --bg: #050816;
      --card: #020617;
      --accent: #22d3ee;
      --accent-soft: rgba(34, 211, 238, 0.10);
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --border-subtle: #1f2937;
      --shadow-soft: 0 22px 45px rgba(15, 23, 42, 0.9);
      --radius-xl: 18px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Inter", system-ui, sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      color: var(--text-main);
      padding: 24px;
    }
    .dashboard { max-width: 1500px; margin: 0 auto 40px auto; }
    header { display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px; }
    .badge {
      display: inline-flex; align-items: center; gap: 8px;
      font-size: 12px; text-transform: uppercase; letter-spacing: 0.16em;
      color: var(--accent); background: var(--accent-soft);
      padding: 6px 12px; border-radius: 999px; border: 1px solid rgba(34,211,238,0.45);
    }
    h1 { font-size: 28px; font-weight: 700; letter-spacing: 0.04em; }
    header p { max-width: 820px; color: var(--text-muted); font-size: 14px; line-height: 1.6; }
    .tagline { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
    .tagline span {
      font-size: 11px; padding: 4px 10px; border-radius: 999px;
      background: rgba(15,23,42,0.85); border: 1px solid rgba(148,163,184,0.6);
    }
    .grid-3 { display: grid; grid-template-columns: 2fr 2fr 1.5fr; gap: 18px; align-items: flex-start; }
    @media (max-width: 1200px) { .grid-3 { grid-template-columns: 1fr; } }
    .grid-2 { display: grid; grid-template-columns: 1.5fr 1.5fr; gap: 18px; margin-top: 18px; }
    @media (max-width: 1200px) { .grid-2 { grid-template-columns: 1fr; } }
    .grid-2-vertical { display: grid; grid-template-columns: 1.2fr 1.2fr; gap: 18px; margin-top: 18px; }
    @media (max-width: 1200px) { .grid-2-vertical { grid-template-columns: 1fr; } }
    .card {
      background: radial-gradient(circle at 0 0, rgba(34, 211, 238, 0.09) 0, transparent 55%), var(--card);
      border-radius: var(--radius-xl);
      border: 1px solid var(--border-subtle);
      padding: 16px 18px 18px 18px;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }
    .card-inner { position: relative; z-index: 1; }
    .card h2 { font-size: 15px; margin-bottom: 6px; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; }
    .card h3 { font-size: 14px; margin-bottom: 4px; font-weight: 600; }
    .card p { font-size: 13px; color: var(--text-muted); }
    .kpi-grid { display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 10px; margin-top: 10px; }
    @media (max-width: 1000px) { .kpi-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    @media (max-width: 650px) { .kpi-grid { grid-template-columns: 1fr; } }
    .kpi-card {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 14px;
      padding: 10px 10px 12px 10px;
      border: 1px solid #1f2937;
      display: flex; flex-direction: column; gap: 4px;
    }
    .kpi-label { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.12em; }
    .kpi-value { font-size: 19px; font-weight: 600; display: flex; align-items: baseline; gap: 4px; }
    .kpi-value span.unit { font-size: 11px; color: var(--text-muted); }
    .kpi-trend { font-size: 11px; color: var(--text-muted); }
    .pill {
      font-size: 10px; padding: 2px 6px; border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5); margin-left: 4px;
    }
    .pill.high { border-color: rgba(248,113,113,0.9); color: #fecaca; }
    .pill.medium { border-color: rgba(250,204,21,0.9); color: #fef3c7; }
    .pill.low { border-color: rgba(74,222,128,0.9); color: #dcfce7; }
    .chart-wrapper { margin-top: 12px; height: 250px; }
    .chart-wrapper.tall { height: 300px; }
    .chart-caption { font-size: 11px; color: var(--text-muted); margin-top: 6px; line-height: 1.4; }
    .story-list { list-style: none; display: grid; gap: 6px; margin-top: 6px; }
    .story-item { display: flex; gap: 8px; font-size: 13px; color: var(--text-muted); }
    .story-dot { margin-top: 4px; width: 8px; height: 8px; border-radius: 999px; background: var(--accent); box-shadow: 0 0 8px rgba(34,211,238,0.9); }
    .mini-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 12px; margin-top: 12px; }
    .badge-small { font-size: 10px; padding: 2px 6px; border-radius: 999px; border: 1px solid rgba(148,163,184,0.4); }
    footer { margin-top: 26px; font-size: 11px; color: var(--text-muted); text-align: right; opacity: 0.8; }
  </style>
</head>
<body>
  <div class="dashboard">
    <header>
      <div class="badge">Driver Behaviour & Safety Analytics</div>
      <h1>Driver Behaviour, Fatigue & Road Risk – Data Insight Dashboard</h1>
      <p>
        This dashboard uses a synthetic telematics dataset (50 000+ records) to explore how
        driver behaviour – including distraction, eating, smoking, fatigue, drowsiness and seatbelt
        compliance – shapes overall risk on the road. It is designed for stakeholders who want
        to see the evidence behind behaviour-focused road-safety interventions.
      </p>
      <div class="tagline">
        <span>Behavioural risk quantification</span>
        <span>Fatigue & drowsiness analysis</span>
        <span>Distraction & secondary tasks</span>
        <span>Seatbelt compliance impact</span>
        <span>Risk distribution & profiling</span>
      </div>
    </header>

    <!-- Top section: KPI + Behaviour vs Risk + Risk Distribution -->
    <section class="card">
      <div class="card-inner">
        <h2>Behavioural Safety Pulse</h2>
        <p>High-level indicators that summarise how often drivers are in unsafe states.</p>
        <div class="kpi-grid">
          <div class="kpi-card">
            <div class="kpi-label">Time Distracted</div>
            <div class="kpi-value">
              <span>24.3</span><span class="unit">%</span>
            </div>
            <div class="kpi-trend">
              Proportion of all time steps with any distraction signal.
              <span class="pill high">Material exposure</span>
            </div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Time Drowsy (drowsiness_score &gt; 0.5)</div>
            <div class="kpi-value">
              <span>1.0</span><span class="unit">%</span>
            </div>
            <div class="kpi-trend">
              Windows where drowsiness indicators are elevated.
              <span class="pill medium">Early-risk window</span>
            </div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Seatbelt Non-Compliance</div>
            <div class="kpi-value">
              <span>8.0</span><span class="unit">%</span>
            </div>
            <div class="kpi-trend">
              Time where seatbelt is recorded as OFF.
              <span class="pill high">Severity amplifier</span>
            </div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">High-Risk Episodes</div>
            <div class="kpi-value">
              <span>88</span><span class="unit">segments</span>
            </div>
            <div class="kpi-trend">
              Number of records with risk_score &gt; 0.65.
            </div>
          </div>
        </div>

        <div class="grid-3" style="margin-top:16px;">
          <div>
            <div class="chart-wrapper tall">
              <canvas id="behaviourRiskChart"></canvas>
            </div>
            <p class="chart-caption">
              Average risk score for key behaviours. High fatigue and high drowsiness show the
              strongest association with increased risk, followed by phone use, eating and
              smoking while driving.
            </p>
          </div>
          <div>
            <div class="chart-wrapper tall">
              <canvas id="riskHistogram"></canvas>
            </div>
            <p class="chart-caption">
              Distribution of risk scores across the dataset. Most records sit in the lower-risk
              range, but there is a clear tail of elevated risk that warrants attention and
              possible intervention.
            </p>
          </div>
          <div>
            <div class="chart-wrapper tall">
              <canvas id="fatigueBucketChart"></canvas>
            </div>
            <p class="chart-caption">
              Share of time in low, moderate and high fatigue buckets. Even in a synthetic
              scenario, a non-trivial fraction of driving time occurs under moderate-to-high
              fatigue conditions.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Middle: Drowsiness + Distraction + Seatbelt + Time of Day -->
    <div class="grid-2">
      <section class="card">
        <div class="card-inner">
          <h2>Drowsiness (PERCLOS) vs Risk</h2>
          <div class="chart-wrapper tall">
            <canvas id="perclosRiskChart"></canvas>
          </div>
          <p class="chart-caption">
            Binned relationship between average PERCLOS (fraction of time eyes are closed) and
            average risk score. Higher PERCLOS bands systematically correspond to higher risk.
          </p>
        </div>
      </section>

      <section class="card">
        <div class="card-inner">
          <h2>Distraction & Secondary Activities</h2>
          <div class="chart-wrapper">
            <canvas id="distractionPieChart"></canvas>
          </div>
          <p class="chart-caption">
            Relative contribution of phone use, eating and smoking among all time steps flagged
            as distracted. Multiple sources may occur at once in the same record.
          </p>
          <div class="chart-wrapper" style="height:190px; margin-top:14px;">
            <canvas id="distractionRiskBarChart"></canvas>
          </div>
        </div>
      </section>
    </div>

    <div class="grid-2-vertical">
      <section class="card">
        <div class="card-inner">
          <h2>Seatbelt Compliance & Risk</h2>
          <div class="chart-wrapper">
            <canvas id="seatbeltRiskChart"></canvas>
          </div>
          <p class="chart-caption">
            Comparison of average risk for seatbelt ON vs seatbelt OFF. Non-compliant periods
            consistently carry higher risk in the synthetic data.
          </p>
          <div class="chart-wrapper" style="height:210px; margin-top:14px;">
            <canvas id="highRiskShareChart"></canvas>
          </div>
          <p class="chart-caption">
            Share of high-risk samples (risk_score &gt; 0.65) overall versus within specific
            behaviours. Behaviours above the baseline line are over-represented in high-risk
            windows.
          </p>
        </div>
      </section>

      <section class="card">
        <div class="card-inner">
          <h2>Temporal & Trip-Level Patterns</h2>
          <div class="chart-wrapper">
            <canvas id="hourlyRiskChart"></canvas>
          </div>
          <p class="chart-caption">
            Average risk score by hour of day in the synthetic run. Temporal patterns can be
            explored in real deployments to identify higher-risk times.
          </p>
          <div class="chart-wrapper" style="height:210px; margin-top:14px;">
            <canvas id="timeSeriesChart"></canvas>
          </div>
          <p class="chart-caption">
            Example short segment from the dataset, showing how risk can fluctuate within a
            trip as speed and behaviour change.
          </p>
        </div>
      </section>
    </div>

    <!-- Bottom: Correlation matrix + Profiles -->
    <div class="grid-2" style="margin-top:18px;">
      <section class="card">
        <div class="card-inner">
          <h2>Correlation Heatmap – Behaviour & Risk</h2>
          <div class="chart-wrapper tall">
            <canvas id="corrMatrixChart"></canvas>
          </div>
          <p class="chart-caption">
            Correlation matrix between core variables (speed, PERCLOS, fatigue, drowsiness,
            distraction, seatbelt, etc.). This highlights how strongly each behaviour aligns
            with the risk score in the synthetic data.
          </p>
        </div>
      </section>

      <section class="card">
        <div class="card-inner">
          <h2>Behavioural Risk Profiles</h2>
          <p style="font-size:13px; color:var(--text-muted); margin-bottom:4px;">
            Samples can be grouped into rough profiles to understand how different factors
            combine to form different risk shapes.
          </p>
          <div class="chart-wrapper tall">
            <canvas id="clusterRadarChart"></canvas>
          </div>
          <p class="chart-caption">
            Profiles derived from the synthetic data: low-risk samples ("safe"), segments dominated
            by distraction, segments with high fatigue, and segments with very high combined risk.
          </p>
        </div>
      </section>
    </div>

    <footer>
      Synthetic dataset: 50 000+ records of second-by-second driver behaviour and risk indicators,
      generated for analysis and dashboard design.
    </footer>
  </div>

  <script>
    // Behaviour vs risk
    const behaviourRiskCtx = document.getElementById("behaviourRiskChart").getContext("2d");
    new Chart(behaviourRiskCtx, {
      type: "bar",
      data: {
        labels: ["Phone usage", "Eating", "Smoking", "Seatbelt OFF", "High fatigue", "High drowsiness"],
        datasets: [{
          label: "Average risk score",
          data: [
            0.385,
            0.385,
            0.384,
            0.337,
            0.393,
            0.427
          ],
          backgroundColor: [
            "rgba(59,130,246,0.9)",
            "rgba(251,191,36,0.9)",
            "rgba(234,179,8,0.9)",
            "rgba(220,38,38,0.9)",
            "rgba(37,99,235,0.9)",
            "rgba(56,189,248,0.9)"
          ],
          borderRadius: 8,
          maxBarThickness: 44
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: { color: "#e5e7eb", font: { size: 11 } },
            grid: { display: false }
          },
          y: {
            beginAtZero: true,
            max: 1,
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(55,65,81,0.6)" }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1,
            titleFont: { size: 12 },
            bodyFont: { size: 11 }
          }
        }
      }
    });

    // Risk histogram
    const riskHistCtx = document.getElementById("riskHistogram").getContext("2d");
    new Chart(riskHistCtx, {
      type: "bar",
      data: {
        labels: [0.05, 0.15, 0.25, 0.35, 0.45, 0.55, 0.65, 0.75, 0.85, 0.95],
        datasets: [{ 
          label: "Count",
          data: [4409, 11832, 15537, 11176, 5248, 1509, 265, 24, 0, 0],
          backgroundColor: "rgba(34,197,94,0.85)",
          borderRadius: 6,
          maxBarThickness: 26
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            title: { display: true, text: "Risk score bins", color: "#e5e7eb", font: { size: 11 } },
            ticks: { color: "#9ca3af", font: { size: 10 } },
            grid: { display: false }
          },
          y: {
            beginAtZero: true,
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Fatigue bucket chart
    const fatigueBucketCtx = document.getElementById("fatigueBucketChart").getContext("2d");
    new Chart(fatigueBucketCtx, {
      type: "bar",
      data: {
        labels: ['Low (0-0.3)', 'Moderate (0.3-0.6)', 'High (0.6-1.0)'],
        datasets: [{ 
          label: "Count",
          data: [39158, 10709, 133],
          backgroundColor: "rgba(129,140,248,0.9)",
          borderRadius: 6,
          maxBarThickness: 30
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: { color: "#e5e7eb", font: { size: 11 } },
            grid: { display: false }
          },
          y: {
            beginAtZero: true,
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // PERCLOS vs risk
    const perclosRiskCtx = document.getElementById("perclosRiskChart").getContext("2d");
    const perclosRiskData = [
      { x: 0.0432, y: 0.2347 },
      { x: 0.1134, y: 0.2490 },
      { x: 0.1893, y: 0.2723 },
      { x: 0.2658, y: 0.2908 },
      { x: 0.3420, y: 0.3121 },
      { x: 0.4164, y: 0.3371 },
      { x: 0.4923, y: 0.3512 },
      { x: 0.5700, y: 0.3934 },
      { x: 0.6441, y: 0.4147 },
      { x: 0.7332, y: 0.4021 }
    ];
    new Chart(perclosRiskCtx, {
      type: "scatter",
      data: {
        datasets: [
          {
            label: "Bins",
            data: perclosRiskData,
            pointRadius: 4,
            pointBackgroundColor: "rgba(34,211,238,0.9)",
            pointBorderColor: "#0f172a"
          },
          {
            label: "Trend",
            type: "line",
            data: perclosRiskData,
            parsing: false,
            borderColor: "rgba(56,189,248,0.9)",
            borderWidth: 2,
            pointRadius: 0,
            tension: 0.2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            title: { display: true, text: "Average PERCLOS in bin", color: "#e5e7eb", font: { size: 11 } },
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          },
          y: {
            title: { display: true, text: "Average risk score", color: "#e5e7eb", font: { size: 11 } },
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" },
            min: 0, max: 1
          }
        },
        plugins: {
          legend: { labels: { color: "#e5e7eb", font: { size: 11 } } },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Distraction pie
    const distractionPieCtx = document.getElementById("distractionPieChart").getContext("2d");
    new Chart(distractionPieCtx, {
      type: "doughnut",
      data: {
        labels: ["Phone usage", "Eating", "Smoking", "Other"],
        datasets: [{ 
          data: [5995, 4076, 3037, 0],
          backgroundColor: [
            "rgba(59,130,246,0.9)",
            "rgba(251,191,36,0.9)",
            "rgba(234,179,8,0.9)",
            "rgba(148,163,184,0.9)"
          ],
          borderWidth: 0
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: "62%",
        plugins: {
          legend: { position: "bottom", labels: { color: "#e5e7eb", font: { size: 11 }, padding: 10 } },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Distraction vs risk bar
    const distractionRiskCtx = document.getElementById("distractionRiskBarChart").getContext("2d");
    new Chart(distractionRiskCtx, {
      type: "bar",
      data: {
        labels: ["No distraction", "Distracted"],
        datasets: [{ 
          label: "Average risk score",
          data: [0.224, 0.385],
          backgroundColor: [
            "rgba(52,211,153,0.9)",
            "rgba(248,113,113,0.9)"
          ],
          borderRadius: 9,
          maxBarThickness: 40
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: { color: "#e5e7eb", font: { size: 11 } },
            grid: { display: false }
          },
          y: {
            beginAtZero: true,
            max: 1,
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Seatbelt vs risk
    const seatbeltRiskCtx = document.getElementById("seatbeltRiskChart").getContext("2d");
    new Chart(seatbeltRiskCtx, {
      type: "bar",
      data: {
        labels: ["Seatbelt ON", "Seatbelt OFF"],
        datasets: [{ 
          label: "Average risk score",
          data: [0.257, 0.337],
          backgroundColor: [
            "rgba(52,211,153,0.9)",
            "rgba(220,38,38,0.9)"
          ],
          borderRadius: 9,
          maxBarThickness: 40
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: { color: "#e5e7eb", font: { size: 11 } },
            grid: { display: false }
          },
          y: {
            beginAtZero: true,
            max: 1,
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // High risk share chart
    const highRiskShareCtx = document.getElementById("highRiskShareChart").getContext("2d");
    new Chart(highRiskShareCtx, {
      type: "bar",
      data: {
        labels: ["Overall", "Phone", "Eating", "Smoking", "Seatbelt OFF", "High fatigue", "High drowsiness"],
        datasets: [{ 
          label: "Share of high-risk samples",
          data: [
            0.002,
            0.007,
            0.007,
            0.006,
            0.008,
            0.015,
            0.026
          ],
          backgroundColor: "rgba(248,250,252,0.9)",
          borderRadius: 7,
          maxBarThickness: 26
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: { color: "#e5e7eb", font: { size: 10 } },
            grid: { display: false }
          },
          y: {
            beginAtZero: true,
            max: 1,
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Hourly risk
    const hourlyRiskCtx = document.getElementById("hourlyRiskChart").getContext("2d");
    new Chart(hourlyRiskCtx, {
      type: "line",
      data: {
        labels: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23],
        datasets: [{ 
          label: "Average risk score",
          data: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.264, 0.263, 0.261, 0.263, 0.264, 0.26, 0.262, 0.264, 0.265, 0.259, 0.264, 0.266, 0.268, 0.262, 0.0, 0.0, 0.0, 0.0],
          borderColor: "rgba(129,140,248,0.9)",
          borderWidth: 2,
          tension: 0.25,
          pointRadius: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            title: { display: true, text: "Hour of day", color: "#e5e7eb", font: { size: 11 } },
            ticks: { color: "#9ca3af", font: { size: 10 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          },
          y: {
            beginAtZero: true,
            max: 1,
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Time series example
    const timeSeriesCtx = document.getElementById("timeSeriesChart").getContext("2d");
    const labelsTime = ['06:16', '06:16', '06:17', '06:17', '06:17', '06:17', '06:18', '06:18'];
    const speedData = [108.0, 84.0, 74.8, 97.7, 95.4, 70.1, 78.6, 59.2];
    const riskData = [0.199, 0.186, 0.294, 0.437, 0.244, 0.277, 0.31, 0.385];
    new Chart(timeSeriesCtx, {
      type: "line",
      data: {
        labels: labelsTime,
        datasets: [
          {
            label: "Speed (km/h)",
            data: speedData,
            borderColor: "rgba(59,130,246,0.9)",
            borderWidth: 2,
            tension: 0.25,
            yAxisID: "y"
          },
          {
            label: "Risk score",
            data: riskData,
            borderColor: "rgba(248,113,113,0.9)",
            borderWidth: 2,
            tension: 0.25,
            yAxisID: "y1"
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            type: "linear",
            position: "left",
            title: { display: true, text: "Speed (km/h)", color: "#e5e7eb", font: { size: 11 } },
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          },
          y1: {
            type: "linear",
            position: "right",
            title: { display: true, text: "Risk score", color: "#e5e7eb", font: { size: 11 } },
            ticks: { color: "#9ca3af", font: { size: 11 } },
            grid: { drawOnChartArea: false },
            min: 0, max: 1
          },
          x: {
            ticks: { color: "#9ca3af", font: { size: 10 } },
            grid: { color: "rgba(31,41,55,0.7)" }
          }
        },
        plugins: {
          legend: { labels: { color: "#e5e7eb", font: { size: 11 } } },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Correlation heatmap using matrix chart
    const corrCtx = document.getElementById("corrMatrixChart").getContext("2d");
    const corrData = [
      { x: 0, y: 0, v: 1.000 },
      { x: 1, y: 0, v: -0.003 },
      { x: 2, y: 0, v: -0.003 },
      { x: 3, y: 0, v: -0.001 },
      { x: 4, y: 0, v: 0.001 },
      { x: 5, y: 0, v: 0.004 },
      { x: 6, y: 0, v: 0.002 },
      { x: 7, y: 0, v: 0.004 },
      { x: 8, y: 0, v: 0.003 },
      { x: 9, y: 0, v: 0.473 },
      { x: 0, y: 1, v: -0.003 },
      { x: 1, y: 1, v: 1.000 },
      { x: 2, y: 1, v: 0.491 },
      { x: 3, y: 1, v: 0.759 },
      { x: 4, y: 1, v: 0.005 },
      { x: 5, y: 1, v: -0.008 },
      { x: 6, y: 1, v: -0.007 },
      { x: 7, y: 1, v: -0.002 },
      { x: 8, y: 1, v: -0.002 },
      { x: 9, y: 1, v: 0.244 },
      { x: 0, y: 2, v: -0.003 },
      { x: 1, y: 2, v: 0.491 },
      { x: 2, y: 2, v: 1.000 },
      { x: 3, y: 2, v: 0.371 },
      { x: 4, y: 2, v: 0.001 },
      { x: 5, y: 2, v: -0.003 },
      { x: 6, y: 2, v: -0.006 },
      { x: 7, y: 2, v: 0.004 },
      { x: 8, y: 2, v: -0.002 },
      { x: 9, y: 2, v: 0.257 },
      { x: 0, y: 3, v: -0.001 },
      { x: 1, y: 3, v: 0.759 },
      { x: 2, y: 3, v: 0.371 },
      { x: 3, y: 3, v: 1.000 },
      { x: 4, y: 3, v: 0.003 },
      { x: 5, y: 3, v: -0.006 },
      { x: 6, y: 3, v: -0.004 },
      { x: 7, y: 3, v: -0.002 },
      { x: 8, y: 3, v: -0.001 },
      { x: 9, y: 3, v: 0.272 },
      { x: 0, y: 4, v: 0.001 },
      { x: 1, y: 4, v: 0.005 },
      { x: 2, y: 4, v: 0.001 },
      { x: 3, y: 4, v: 0.003 },
      { x: 4, y: 4, v: 1.000 },
      { x: 5, y: 4, v: 0.000 },
      { x: 6, y: 4, v: -0.001 },
      { x: 7, y: 4, v: 0.001 },
      { x: 8, y: 4, v: 0.651 },
      { x: 9, y: 4, v: 0.363 },
      { x: 0, y: 5, v: 0.004 },
      { x: 1, y: 5, v: -0.008 },
      { x: 2, y: 5, v: -0.003 },
      { x: 3, y: 5, v: -0.006 },
      { x: 4, y: 5, v: 0.000 },
      { x: 5, y: 5, v: 1.000 },
      { x: 6, y: 5, v: -0.005 },
      { x: 7, y: 5, v: -0.002 },
      { x: 8, y: 5, v: 0.526 },
      { x: 9, y: 5, v: 0.293 },
      { x: 0, y: 6, v: 0.002 },
      { x: 1, y: 6, v: -0.007 },
      { x: 2, y: 6, v: -0.006 },
      { x: 3, y: 6, v: -0.004 },
      { x: 4, y: 6, v: -0.001 },
      { x: 5, y: 6, v: -0.005 },
      { x: 6, y: 6, v: 1.000 },
      { x: 7, y: 6, v: 0.001 },
      { x: 8, y: 6, v: 0.449 },
      { x: 9, y: 6, v: 0.249 },
      { x: 0, y: 7, v: 0.004 },
      { x: 1, y: 7, v: -0.002 },
      { x: 2, y: 7, v: 0.004 },
      { x: 3, y: 7, v: -0.002 },
      { x: 4, y: 7, v: 0.001 },
      { x: 5, y: 7, v: -0.002 },
      { x: 6, y: 7, v: 0.001 },
      { x: 7, y: 7, v: 1.000 },
      { x: 8, y: 7, v: -0.001 },
      { x: 9, y: 7, v: -0.176 },
      { x: 0, y: 8, v: 0.003 },
      { x: 1, y: 8, v: -0.002 },
      { x: 2, y: 8, v: -0.002 },
      { x: 3, y: 8, v: -0.001 },
      { x: 4, y: 8, v: 0.651 },
      { x: 5, y: 8, v: 0.526 },
      { x: 6, y: 8, v: 0.449 },
      { x: 7, y: 8, v: -0.001 },
      { x: 8, y: 8, v: 1.000 },
      { x: 9, y: 8, v: 0.557 },
      { x: 0, y: 9, v: 0.473 },
      { x: 1, y: 9, v: 0.244 },
      { x: 2, y: 9, v: 0.257 },
      { x: 3, y: 9, v: 0.272 },
      { x: 4, y: 9, v: 0.363 },
      { x: 5, y: 9, v: 0.293 },
      { x: 6, y: 9, v: 0.249 },
      { x: 7, y: 9, v: -0.176 },
      { x: 8, y: 9, v: 0.557 },
      { x: 9, y: 9, v: 1.000 }
    ];
    const corrLabels = ['speed_kmh', 'perclos', 'fatigue_level', 'drowsiness_score', 'phone_usage', 'eating', 'smoking', 'seatbelt_on', 'distraction_flag', 'risk_score'];
    new Chart(corrCtx, {
      type: "matrix",
      data: {
        datasets: [{
          label: "Correlation",
          data: corrData,
          backgroundColor(ctx) {
            const value = ctx.dataset.data[ctx.dataIndex].v;
            const alpha = Math.abs(value);
            if (value >= 0) {
              return `rgba(34,197,94,${alpha})`;
            } else {
              return `rgba(248,113,113,${alpha})`;
            }
          },
          width: () => 18,
          height: () => 18,
          borderWidth: 1,
          borderColor: "rgba(15,23,42,0.9)"
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            type: "category",
            labels: corrLabels,
            position: "top",
            ticks: { color: "#e5e7eb", font: { size: 9 } },
            grid: { display: false }
          },
          y: {
            type: "category",
            labels: corrLabels,
            ticks: { color: "#e5e7eb", font: { size: 9 } },
            grid: { display: false }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              title: () => "",
              label(ctx) {
                const d = ctx.raw;
                const xLabel = corrLabels[d.x];
                const yLabel = corrLabels[d.y];
                return `${yLabel} vs ${xLabel}: r = ${d.v}`;
              }
            },
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });

    // Radar chart for profiles
    const radarCtx = document.getElementById("clusterRadarChart").getContext("2d");
    new Chart(radarCtx, {
      type: "radar",
      data: {
        labels: ["Speed risk", "Fatigue", "Drowsiness", "Distraction", "Seatbelt non-compliance"],
        datasets: [
          {
            label: "Safe profile",
            data: [0.182, 0.171, 0.152, 0.047, 0.040],
            borderColor: "rgba(52,211,153,0.9)",
            backgroundColor: "rgba(52,211,153,0.25)",
            borderWidth: 2,
            pointRadius: 2
          },
          {
            label: "Distracted profile",
            data: [0.254, 0.195, 0.174, 1.000, 0.069],
            borderColor: "rgba(59,130,246,0.9)",
            backgroundColor: "rgba(59,130,246,0.25)",
            borderWidth: 2,
            pointRadius: 2
          },
          {
            label: "Fatigued profile",
            data: [0.285, 0.739, 0.431, 0.368, 0.053],
            borderColor: "rgba(234,179,8,0.9)",
            backgroundColor: "rgba(234,179,8,0.22)",
            borderWidth: 2,
            pointRadius: 2
          },
          {
            label: "Multi-risk profile",
            data: [0.699, 0.319, 0.320, 1.000, 0.542],
            borderColor: "rgba(248,113,113,0.9)",
            backgroundColor: "rgba(248,113,113,0.23)",
            borderWidth: 2,
            pointRadius: 2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          r: {
            angleLines: { color: "rgba(31,41,55,0.7)" },
            grid: { color: "rgba(31,41,55,0.7)" },
            pointLabels: { color: "#e5e7eb", font: { size: 11 } },
            ticks: { display: false, max: 1, min: 0 }
          }
        },
        plugins: {
          legend: { position: "bottom", labels: { color: "#e5e7eb", font: { size: 11 } } },
          tooltip: {
            backgroundColor: "#020617",
            borderColor: "#4b5563",
            borderWidth: 1
          }
        }
      }
    });
  </script>
</body>
</html>
